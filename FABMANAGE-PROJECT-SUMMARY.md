# üìã FabManage-Clean ‚Äì Kompleksowy Dokument Projektowy

## _System ZarzƒÖdzania Projektami Produkcyjnymi dla Scenografii i Dekoracji_

---

## üéØ **1. OPIS PROJEKTU I CELE STRATEGICZNE**

### **Wizja Projektu**

FabManage-Clean to nowoczesna platforma zarzƒÖdzania projektami produkcyjnymi specjalnie zaprojektowana dla bran≈ºy scenograficznej i dekoracyjnej. System umo≈ºliwia kompleksowe zarzƒÖdzanie cyklem ≈ºycia projektu od koncepcji po finalnƒÖ realizacjƒô, z naciskiem na elastyczno≈õƒá, real-time monitoring oraz precyzyjnƒÖ kontrolƒô koszt√≥w.

### **Kluczowe Cele Biznesowe**

- **Modularno≈õƒá**: Dynamiczna aktywacja modu≈Ç√≥w projekt√≥w w zale≈ºno≈õci od potrzeb
- **Elastyczno≈õƒá**: Konfigurowanie workflow'√≥w w trakcie realizacji projektu
- **Transparentno≈õƒá**: Live-przeliczenia wycen i real-time tracking postƒôpu
- **Wsp√≥≈Çpraca**: Zespo≈Çowa komunikacja i timeline aktywno≈õci
- **Kontrola Koszt√≥w**: Precyzyjne zarzƒÖdzanie BOM, logistykƒÖ i zakwaterowaniem
- **Integracja**: ≈ÅƒÖczenie z zewnƒôtrznymi systemami (CAD/Speckle, Booking API)

### **Grupa Docelowa**

- **Producent scenograficzny** - zarzƒÖdzanie wieloma projektami jednocze≈õnie
- **Dekorator** - planowanie i realizacja projekt√≥w dekoracyjnych
- **Kierownik produkcji** - kontrola koszt√≥w i harmonogram√≥w
- **Zesp√≥≈Ç projektowy** - wsp√≥≈Çpraca nad szczeg√≥≈Çami technicznymi
- **Klient** - monitoring postƒôpu i zatwierdzanie etap√≥w

---

## üèóÔ∏è **2. ARCHITEKTURA SYSTEMU**

### **2.1 Stack Technologiczny**

#### **Frontend**

```typescript
// G≈Ç√≥wne technologie
const techStack = {
  framework: "React 18 + TypeScript",
  buildTool: "Vite",
  ui: "Ant Design + Custom Design System",
  stateManagement: "Zustand + TanStack Query",
  styling: "Design Tokens z Figma",
  testing: "Vitest + Playwright + Testing Library",
  deployment: "Docker + PWA",
};
```

#### **Backend & Infrastruktura**

```yaml
Database: Supabase PostgreSQL
Authentication: Supabase Auth + RLS
Real-time: Supabase Realtime
Storage: Supabase Storage
API: REST + GraphQL (opcjonalnie)
Deployment: Docker + Kubernetes
Monitoring: Custom + Supabase Analytics
```

### **2.2 Architektura Komponentowa**

#### **Atomic Design Structure**

```
src/
‚îú‚îÄ‚îÄ new-ui/
‚îÇ   ‚îú‚îÄ‚îÄ atoms/           # Button, Input, Badge, Icon
‚îÇ   ‚îú‚îÄ‚îÄ molecules/       # SearchBox, FormField, StatusCard
‚îÇ   ‚îú‚îÄ‚îÄ organisms/       # DataTable, KanbanBoard, Drawer
‚îÇ   ‚îú‚îÄ‚îÄ templates/       # ProjectLayout, ModuleLayout
‚îÇ   ‚îî‚îÄ‚îÄ pages/          # ProjectDetails, Materials, etc.
‚îú‚îÄ‚îÄ design-system/
‚îÇ   ‚îú‚îÄ‚îÄ tokens/         # Design tokens z Figma
‚îÇ   ‚îú‚îÄ‚îÄ components/     # Reusable components
‚îÇ   ‚îî‚îÄ‚îÄ utils/         # Helper functions
‚îî‚îÄ‚îÄ schemas/           # Zod validation schemas
```

#### **State Management Architecture**

```typescript
// Zustand stores per domena
interface StateArchitecture {
  projects: ProjectStore; // G≈Ç√≥wne dane projekt√≥w
  materials: MaterialStore; // Materia≈Çy i BOM
  tiles: TileStore; // Elementy projektu (Kanban)
  logistics: LogisticsStore; // Logistyka i transport
  accommodation: AccommodationStore; // Zakwaterowanie
  pricing: PricingStore; // Wyceny i kalkulacje
  ui: UIStore; // Stan interfejsu
  auth: AuthStore; // Autoryzacja
}
```

---

## üìä **3. MODU≈ÅY PROJEKTU I ZALE≈ªNO≈öCI**

### **3.1 Mapa Modu≈Ç√≥w i Zale≈ºno≈õci**

```mermaid
graph TD
    A[Og√≥lne] --> B[Pliki]
    A --> C[Koncepcja]
    A --> D[Wycena]
    D --> E[Materia≈Çy]
    D --> F[Logistyka]
    D --> G[Zakwaterowanie]
    A --> H[Elementy/P≈Çytki]
    A --> I[Dokumenty]

    E --> D
    F --> D
    G --> D
    H --> D
```

### **3.2 Szczeg√≥≈Çowy Opis Modu≈Ç√≥w**

#### **üéØ Modu≈Ç "Og√≥lne"** _(Core Module)_

**Funkcjonalno≈õƒá:**

- Metadane projektu (nazwa, klient, bud≈ºet, daty)
- Formularz edycji podstawowych informacji
- Komentarze zespo≈Çu z real-time updates
- Timeline aktywno≈õci projektu
- Konfiguracja aktywnych modu≈Ç√≥w

**Zale≈ºno≈õci Backend:**

```sql
-- G≈Ç√≥wne tabele
projects (id, name, client_id, status, budget, modules, created_at, updated_at)
project_messages (id, project_id, author_id, body_html, created_at)
project_activity (id, project_id, type, payload_json, actor_id, created_at)
project_modules (id, project_id, module_name, is_active, configuration)
```

**Komponenty UI:**

- `ProjectHeader` - podstawowe informacje
- `ProjectMessages` - lista komentarzy z composer
- `ProjectTimeline` - historia aktywno≈õci
- `ModuleConfig` - konfiguracja modu≈Ç√≥w

---

#### **üìÅ Modu≈Ç "Pliki"**

**Funkcjonalno≈õƒá:**

- Hierarchiczna struktura katalog√≥w projektu
- Upload/download plik√≥w z drag&drop
- Wersjonowanie plik√≥w
- PodglƒÖd plik√≥w (obrazy, PDF)
- Wsp√≥≈Çdzielenie plik√≥w z zespo≈Çem

**Zale≈ºno≈õci Backend:**

```sql
folders (id, project_id, parent_id, name, path, created_at)
files (id, folder_id, name, size, type, url, version, created_at, updated_at)
file_permissions (id, file_id, user_id, permission_type)
```

**Komponenty UI:**

- `FileExplorer` - drzewo katalog√≥w
- `FileUploader` - drag&drop upload
- `FilePreview` - podglƒÖd plik√≥w
- `FileVersioning` - historia wersji

---

#### **üé® Modu≈Ç "Koncepcja"**

**Funkcjonalno≈õƒá:**

- Opis koncepcji projektu
- Mockupy i wizualizacje
- Dokumenty projektowe
- Zatwierdzanie koncepcji przez klienta

**Zale≈ºno≈õci Backend:**

```sql
concepts (id, project_id, title, description, status, created_at, updated_at)
concept_assets (id, concept_id, type, url, metadata, created_at)
concept_approvals (id, concept_id, approver_id, status, comments, created_at)
```

**Komponenty UI:**

- `ConceptEditor` - edycja koncepcji
- `AssetGallery` - galeria mockup√≥w
- `ApprovalWorkflow` - proces zatwierdzania

---

#### **üí∞ Modu≈Ç "Wycena"** _(Agregator Koszt√≥w)_

**Funkcjonalno≈õƒá:**

- Live-przeliczenia koszt√≥w z wszystkich modu≈Ç√≥w
- Agregacja BOM, logistyki, zakwaterowania
- Narzuty i mar≈ºe
- Por√≥wnanie z bud≈ºetem projektu
- Eksport wycen do PDF

**Zale≈ºno≈õci Backend:**

```sql
project_pricing (id, project_id, total_cost, material_cost, logistics_cost,
                accommodation_cost, markup, created_at, updated_at)
pricing_breakdown (id, project_id, category, amount, details, created_at)
```

**Komponenty UI:**

- `PricingDashboard` - g≈Ç√≥wny panel wycen
- `CostBreakdown` - szczeg√≥≈Çowy podzia≈Ç koszt√≥w
- `BudgetComparison` - por√≥wnanie z bud≈ºetem
- `PricingExport` - eksport do PDF

---

#### **üß© Modu≈Ç "Elementy/P≈Çytki"** _(Kanban)_

**Funkcjonalno≈õƒá:**

- Kafelkowy widok element√≥w projektu
- Kanban board z statusami
- Drag&drop miƒôdzy kolumnami
- Terminy i priorytety
- Drawer edycji elementu

**Zale≈ºno≈õci Backend:**

```sql
tiles (id, project_id, name, description, status, priority, deadline,
       assignee_id, created_at, updated_at)
kanban_columns (id, project_id, name, order, color, created_at)
kanban_cards (id, tile_id, column_id, position, created_at)
tile_dependencies (id, tile_id, depends_on_tile_id)
```

**Komponenty UI:**

- `TileGrid` - kafelkowy widok
- `KanbanBoard` - tablica Kanban
- `TileDrawer` - edycja elementu
- `DependencyGraph` - graf zale≈ºno≈õci

---

#### **üì¶ Modu≈Ç "Materia≈Çy"**

**Funkcjonalno≈õƒá:**

- Pozycje BOM (Bill of Materials)
- Stan magazynowy materia≈Ç√≥w
- Zam√≥wienia materia≈Ç√≥w
- Tracking dostaw
- Integracja z wycenƒÖ

**Zale≈ºno≈õci Backend:**

```sql
materials (id, code, name, category, unit_price, inventory_level,
           supplier_id, created_at, updated_at)
bom_items (id, project_id, material_id, quantity, unit_cost,
           total_cost, created_at, updated_at)
material_orders (id, project_id, material_id, quantity, status,
                 order_date, delivery_date, created_at)
inventory_movements (id, material_id, type, quantity, reason, created_at)
```

**Komponenty UI:**

- `BOMTable` - tabela BOM z virtualizacjƒÖ
- `MaterialDrawer` - CRUD pozycji BOM
- `InventoryPanel` - stan magazynowy
- `OrderTracking` - ≈õledzenie zam√≥wie≈Ñ

---

#### **üìÑ Modu≈Ç "Dokumenty"**

**Funkcjonalno≈õƒá:**

- Faktury i dokumenty finansowe
- Umowy i dokumenty prawne
- Certyfikaty i dokumentacja techniczna
- Kategoryzacja dokument√≥w
- Eksport i archiwizacja

**Zale≈ºno≈õci Backend:**

```sql
documents (id, project_id, type, category, title, url, metadata,
           created_at, updated_at)
document_categories (id, name, description, color, created_at)
```

**Komponenty UI:**

- `DocumentLibrary` - biblioteka dokument√≥w
- `DocumentUploader` - upload dokument√≥w
- `DocumentViewer` - podglƒÖd dokument√≥w
- `DocumentExport` - eksport dokument√≥w

---

#### **üöö Modu≈Ç "Logistyka"**

**Funkcjonalno≈õƒá:**

- Zamawianie floty transportowej
- Kalkulacja koszt√≥w transportu
- Tracking dostaw
- Optymalizacja tras
- Live-aktualizacja w wycenie

**Zale≈ºno≈õci Backend:**

```sql
logistics_orders (id, project_id, vehicle_type, quantity, cost_per_unit,
                  total_cost, pickup_date, delivery_date, status, created_at)
transport_routes (id, logistics_order_id, origin, destination, distance,
                  estimated_time, created_at)
```

**Komponenty UI:**

- `LogisticsDashboard` - panel logistyczny
- `RouteOptimizer` - optymalizacja tras
- `DeliveryTracking` - ≈õledzenie dostaw
- `CostCalculator` - kalkulator koszt√≥w

---

#### **üè® Modu≈Ç "Zakwaterowanie"**

**Funkcjonalno≈õƒá:**

- Rezerwacje hoteli i nocleg√≥w
- ZarzƒÖdzanie wy≈ºywieniem
- Katalog partner√≥w
- Integracja z Booking API
- Kalkulacja koszt√≥w zakwaterowania

**Zale≈ºno≈õci Backend:**

```sql
accommodation_bookings (id, project_id, hotel_id, check_in, check_out,
                        guests, cost_per_night, total_cost, status, created_at)
accommodation_partners (id, name, type, location, contact_info,
                        rating, created_at)
meal_orders (id, accommodation_booking_id, meal_type, quantity,
             cost_per_meal, total_cost, created_at)
```

**Komponenty UI:**

- `AccommodationCalendar` - kalendarz rezerwacji
- `PartnerCatalog` - katalog partner√≥w
- `BookingManager` - zarzƒÖdzanie rezerwacjami
- `CostBreakdown` - podzia≈Ç koszt√≥w

---

## üóÑÔ∏è **4. SZCZEG√ì≈ÅOWY SCHEMAT BAZY DANYCH**

### **4.1 G≈Ç√≥wne Tabele Systemu**

```sql
-- ==============================================
-- CORE PROJECT TABLES
-- ==============================================

-- Projekty (g≈Ç√≥wna tabela)
CREATE TABLE projects (
    id UUID PRIMARY KEY DEFAULT gen_random_uuid(),
    name VARCHAR(255) NOT NULL,
    client_id UUID REFERENCES clients(id),
    status VARCHAR(50) DEFAULT 'active',
    budget DECIMAL(12,2),
    start_date DATE,
    end_date DATE,
    modules JSONB DEFAULT '{}', -- Konfiguracja aktywnych modu≈Ç√≥w
    created_at TIMESTAMP WITH TIME ZONE DEFAULT NOW(),
    updated_at TIMESTAMP WITH TIME ZONE DEFAULT NOW(),
    created_by UUID REFERENCES auth.users(id)
);

-- Wiadomo≈õci projektu
CREATE TABLE project_messages (
    id UUID PRIMARY KEY DEFAULT gen_random_uuid(),
    project_id UUID REFERENCES projects(id) ON DELETE CASCADE,
    author_id UUID REFERENCES auth.users(id),
    body_html TEXT NOT NULL,
    created_at TIMESTAMP WITH TIME ZONE DEFAULT NOW(),
    updated_at TIMESTAMP WITH TIME ZONE DEFAULT NOW()
);

-- Aktywno≈õƒá projektu (timeline)
CREATE TABLE project_activity (
    id UUID PRIMARY KEY DEFAULT gen_random_uuid(),
    project_id UUID REFERENCES projects(id) ON DELETE CASCADE,
    type VARCHAR(100) NOT NULL, -- 'message', 'status_change', 'file_upload', etc.
    payload_json JSONB,
    actor_id UUID REFERENCES auth.users(id),
    created_at TIMESTAMP WITH TIME ZONE DEFAULT NOW()
);

-- ==============================================
-- FILES MODULE
-- ==============================================

-- Katalogi plik√≥w
CREATE TABLE folders (
    id UUID PRIMARY KEY DEFAULT gen_random_uuid(),
    project_id UUID REFERENCES projects(id) ON DELETE CASCADE,
    parent_id UUID REFERENCES folders(id),
    name VARCHAR(255) NOT NULL,
    path TEXT NOT NULL,
    created_at TIMESTAMP WITH TIME ZONE DEFAULT NOW(),
    created_by UUID REFERENCES auth.users(id)
);

-- Pliki
CREATE TABLE files (
    id UUID PRIMARY KEY DEFAULT gen_random_uuid(),
    folder_id UUID REFERENCES folders(id) ON DELETE CASCADE,
    name VARCHAR(255) NOT NULL,
    size BIGINT NOT NULL,
    type VARCHAR(100),
    url TEXT NOT NULL,
    version INTEGER DEFAULT 1,
    created_at TIMESTAMP WITH TIME ZONE DEFAULT NOW(),
    updated_at TIMESTAMP WITH TIME ZONE DEFAULT NOW(),
    created_by UUID REFERENCES auth.users(id)
);

-- ==============================================
-- CONCEPT MODULE
-- ==============================================

-- Koncepcje projekt√≥w
CREATE TABLE concepts (
    id UUID PRIMARY KEY DEFAULT gen_random_uuid(),
    project_id UUID REFERENCES projects(id) ON DELETE CASCADE,
    title VARCHAR(255) NOT NULL,
    description TEXT,
    status VARCHAR(50) DEFAULT 'draft',
    created_at TIMESTAMP WITH TIME ZONE DEFAULT NOW(),
    updated_at TIMESTAMP WITH TIME ZONE DEFAULT NOW()
);

-- Zasoby koncepcji (mockupy, wizualizacje)
CREATE TABLE concept_assets (
    id UUID PRIMARY KEY DEFAULT gen_random_uuid(),
    concept_id UUID REFERENCES concepts(id) ON DELETE CASCADE,
    type VARCHAR(100) NOT NULL, -- 'mockup', 'visualization', 'document'
    url TEXT NOT NULL,
    metadata JSONB,
    created_at TIMESTAMP WITH TIME ZONE DEFAULT NOW()
);

-- ==============================================
-- MATERIALS MODULE
-- ==============================================

-- Materia≈Çy
CREATE TABLE materials (
    id UUID PRIMARY KEY DEFAULT gen_random_uuid(),
    code VARCHAR(100) UNIQUE NOT NULL,
    name VARCHAR(255) NOT NULL,
    category VARCHAR(100),
    unit_price DECIMAL(10,2),
    inventory_level INTEGER DEFAULT 0,
    supplier_id UUID REFERENCES suppliers(id),
    created_at TIMESTAMP WITH TIME ZONE DEFAULT NOW(),
    updated_at TIMESTAMP WITH TIME ZONE DEFAULT NOW()
);

-- Pozycje BOM
CREATE TABLE bom_items (
    id UUID PRIMARY KEY DEFAULT gen_random_uuid(),
    project_id UUID REFERENCES projects(id) ON DELETE CASCADE,
    material_id UUID REFERENCES materials(id),
    quantity DECIMAL(10,3) NOT NULL,
    unit_cost DECIMAL(10,2),
    total_cost DECIMAL(12,2),
    created_at TIMESTAMP WITH TIME ZONE DEFAULT NOW(),
    updated_at TIMESTAMP WITH TIME ZONE DEFAULT NOW()
);

-- Zam√≥wienia materia≈Ç√≥w
CREATE TABLE material_orders (
    id UUID PRIMARY KEY DEFAULT gen_random_uuid(),
    project_id UUID REFERENCES projects(id) ON DELETE CASCADE,
    material_id UUID REFERENCES materials(id),
    quantity DECIMAL(10,3) NOT NULL,
    status VARCHAR(50) DEFAULT 'pending',
    order_date DATE,
    delivery_date DATE,
    created_at TIMESTAMP WITH TIME ZONE DEFAULT NOW()
);

-- ==============================================
-- TILES/KANBAN MODULE
-- ==============================================

-- Elementy projektu (p≈Çytki)
CREATE TABLE tiles (
    id UUID PRIMARY KEY DEFAULT gen_random_uuid(),
    project_id UUID REFERENCES projects(id) ON DELETE CASCADE,
    name VARCHAR(255) NOT NULL,
    description TEXT,
    status VARCHAR(50) DEFAULT 'todo',
    priority VARCHAR(20) DEFAULT 'medium',
    deadline DATE,
    assignee_id UUID REFERENCES auth.users(id),
    created_at TIMESTAMP WITH TIME ZONE DEFAULT NOW(),
    updated_at TIMESTAMP WITH TIME ZONE DEFAULT NOW()
);

-- Kolumny Kanban
CREATE TABLE kanban_columns (
    id UUID PRIMARY KEY DEFAULT gen_random_uuid(),
    project_id UUID REFERENCES projects(id) ON DELETE CASCADE,
    name VARCHAR(100) NOT NULL,
    order_index INTEGER NOT NULL,
    color VARCHAR(7),
    created_at TIMESTAMP WITH TIME ZONE DEFAULT NOW()
);

-- Karty Kanban
CREATE TABLE kanban_cards (
    id UUID PRIMARY KEY DEFAULT gen_random_uuid(),
    tile_id UUID REFERENCES tiles(id) ON DELETE CASCADE,
    column_id UUID REFERENCES kanban_columns(id),
    position INTEGER NOT NULL,
    created_at TIMESTAMP WITH TIME ZONE DEFAULT NOW()
);

-- ==============================================
-- LOGISTICS MODULE
-- ==============================================

-- Zam√≥wienia logistyczne
CREATE TABLE logistics_orders (
    id UUID PRIMARY KEY DEFAULT gen_random_uuid(),
    project_id UUID REFERENCES projects(id) ON DELETE CASCADE,
    vehicle_type VARCHAR(100) NOT NULL,
    quantity INTEGER DEFAULT 1,
    cost_per_unit DECIMAL(10,2),
    total_cost DECIMAL(12,2),
    pickup_date DATE,
    delivery_date DATE,
    status VARCHAR(50) DEFAULT 'pending',
    created_at TIMESTAMP WITH TIME ZONE DEFAULT NOW()
);

-- Trasy transportowe
CREATE TABLE transport_routes (
    id UUID PRIMARY KEY DEFAULT gen_random_uuid(),
    logistics_order_id UUID REFERENCES logistics_orders(id) ON DELETE CASCADE,
    origin VARCHAR(255) NOT NULL,
    destination VARCHAR(255) NOT NULL,
    distance DECIMAL(8,2),
    estimated_time INTEGER, -- w minutach
    created_at TIMESTAMP WITH TIME ZONE DEFAULT NOW()
);

-- ==============================================
-- ACCOMMODATION MODULE
-- ==============================================

-- Rezerwacje zakwaterowania
CREATE TABLE accommodation_bookings (
    id UUID PRIMARY KEY DEFAULT gen_random_uuid(),
    project_id UUID REFERENCES projects(id) ON DELETE CASCADE,
    hotel_id UUID REFERENCES accommodation_partners(id),
    check_in DATE NOT NULL,
    check_out DATE NOT NULL,
    guests INTEGER DEFAULT 1,
    cost_per_night DECIMAL(8,2),
    total_cost DECIMAL(10,2),
    status VARCHAR(50) DEFAULT 'pending',
    created_at TIMESTAMP WITH TIME ZONE DEFAULT NOW()
);

-- Partnerzy zakwaterowania
CREATE TABLE accommodation_partners (
    id UUID PRIMARY KEY DEFAULT gen_random_uuid(),
    name VARCHAR(255) NOT NULL,
    type VARCHAR(100), -- 'hotel', 'apartment', 'hostel'
    location VARCHAR(255),
    contact_info JSONB,
    rating DECIMAL(3,2),
    created_at TIMESTAMP WITH TIME ZONE DEFAULT NOW()
);

-- ==============================================
-- PRICING MODULE
-- ==============================================

-- Wyceny projekt√≥w
CREATE TABLE project_pricing (
    id UUID PRIMARY KEY DEFAULT gen_random_uuid(),
    project_id UUID REFERENCES projects(id) ON DELETE CASCADE,
    total_cost DECIMAL(12,2),
    material_cost DECIMAL(12,2),
    logistics_cost DECIMAL(12,2),
    accommodation_cost DECIMAL(12,2),
    markup_percentage DECIMAL(5,2),
    markup_amount DECIMAL(12,2),
    created_at TIMESTAMP WITH TIME ZONE DEFAULT NOW(),
    updated_at TIMESTAMP WITH TIME ZONE DEFAULT NOW()
);

-- Szczeg√≥≈Çowy podzia≈Ç koszt√≥w
CREATE TABLE pricing_breakdown (
    id UUID PRIMARY KEY DEFAULT gen_random_uuid(),
    project_id UUID REFERENCES projects(id) ON DELETE CASCADE,
    category VARCHAR(100) NOT NULL,
    amount DECIMAL(12,2) NOT NULL,
    details JSONB,
    created_at TIMESTAMP WITH TIME ZONE DEFAULT NOW()
);
```

### **4.2 Indeksy i Optymalizacje**

```sql
-- Indeksy dla wydajno≈õci
CREATE INDEX idx_projects_client_id ON projects(client_id);
CREATE INDEX idx_projects_status ON projects(status);
CREATE INDEX idx_project_messages_project_id ON project_messages(project_id);
CREATE INDEX idx_project_activity_project_id ON project_activity(project_id);
CREATE INDEX idx_files_folder_id ON files(folder_id);
CREATE INDEX idx_bom_items_project_id ON bom_items(project_id);
CREATE INDEX idx_tiles_project_id ON tiles(project_id);
CREATE INDEX idx_kanban_cards_column_id ON kanban_cards(column_id);

-- Indeksy dla real-time queries
CREATE INDEX idx_project_messages_created_at ON project_messages(created_at DESC);
CREATE INDEX idx_project_activity_created_at ON project_activity(created_at DESC);
CREATE INDEX idx_tiles_status ON tiles(status);
CREATE INDEX idx_logistics_orders_status ON logistics_orders(status);
```

### **4.3 Row Level Security (RLS)**

```sql
-- W≈ÇƒÖczanie RLS dla wszystkich tabel
ALTER TABLE projects ENABLE ROW LEVEL SECURITY;
ALTER TABLE project_messages ENABLE ROW LEVEL SECURITY;
ALTER TABLE project_activity ENABLE ROW LEVEL SECURITY;
-- ... (dla wszystkich tabel)

-- Polityki RLS - przyk≈Çad dla projects
CREATE POLICY "Users can view projects they have access to" ON projects
    FOR SELECT USING (
        auth.uid() IN (
            SELECT user_id FROM project_permissions
            WHERE project_id = projects.id
        )
    );

CREATE POLICY "Users can update projects they can edit" ON projects
    FOR UPDATE USING (
        auth.uid() IN (
            SELECT user_id FROM project_permissions
            WHERE project_id = projects.id AND permission = 'edit'
        )
    );
```

---

## üöÄ **5. PLAN IMPLEMENTACJI - ROADMAP**

### **5.1 Faza 1: Foundation & Core (MiesiƒÖce 1-3)**

#### **Sprint 1-2: Infrastructure Setup**

- [ ] **Setup Supabase** - konfiguracja bazy danych, RLS, real-time
- [ ] **Database Schema** - implementacja wszystkich tabel z indeksami
- [ ] **Authentication** - setup Supabase Auth z custom claims
- [ ] **Design System** - finalizacja token√≥w i komponent√≥w bazowych
- [ ] **Testing Infrastructure** - setup Vitest, Playwright, CI/CD

#### **Sprint 3-4: Core Services & State Management**

- [ ] **API Services** - implementacja wszystkich serwis√≥w CRUD
- [ ] **Zustand Stores** - setup store'√≥w dla ka≈ºdego modu≈Çu
- [ ] **TanStack Query** - konfiguracja cache i real-time subscriptions
- [ ] **Form Validation** - rozszerzenie schemat√≥w Zod
- [ ] **Error Handling** - globalne error boundaries i logging

#### **Sprint 5-6: Project Layout & Navigation**

- [ ] **ProjectLayout** - g≈Ç√≥wny layout z tabami modu≈Ç√≥w
- [ ] **Module Navigation** - dynamiczne ≈Çadowanie modu≈Ç√≥w
- [ ] **Routing** - lazy loading routes per modu≈Ç
- [ ] **Breadcrumbs** - nawigacja w projekcie
- [ ] **Mobile Responsiveness** - responsive design

### **5.2 Faza 2: Core Modules (MiesiƒÖce 4-6)**

#### **Sprint 7-8: Modu≈Ç "Og√≥lne"**

- [ ] **ProjectHeader** - podstawowe informacje projektu
- [ ] **ProjectMessages** - lista komentarzy z real-time updates
- [ ] **MessageComposer** - formularz dodawania komentarzy
- [ ] **ProjectTimeline** - historia aktywno≈õci z filtrowaniem
- [ ] **ModuleConfig** - konfiguracja aktywnych modu≈Ç√≥w

#### **Sprint 9-10: Modu≈Ç "Elementy/P≈Çytki" (Kanban)**

- [ ] **TileGrid** - kafelkowy widok element√≥w
- [ ] **KanbanBoard** - tablica Kanban z drag&drop
- [ ] **TileDrawer** - formularz edycji elementu
- [ ] **DependencyGraph** - graf zale≈ºno≈õci miƒôdzy elementami
- [ ] **Real-time Updates** - live updates status√≥w

#### **Sprint 11-12: Modu≈Ç "Materia≈Çy"**

- [ ] **BOMTable** - tabela BOM z virtualizacjƒÖ
- [ ] **MaterialDrawer** - CRUD pozycji BOM
- [ ] **InventoryPanel** - stan magazynowy
- [ ] **OrderTracking** - ≈õledzenie zam√≥wie≈Ñ
- [ ] **Integration z WycenƒÖ** - live updates koszt√≥w

### **5.3 Faza 3: Advanced Modules (MiesiƒÖce 7-9)**

#### **Sprint 13-14: Modu≈Ç "Wycena"**

- [ ] **PricingDashboard** - g≈Ç√≥wny panel wycen
- [ ] **CostBreakdown** - szczeg√≥≈Çowy podzia≈Ç koszt√≥w
- [ ] **BudgetComparison** - por√≥wnanie z bud≈ºetem
- [ ] **Live Calculations** - real-time przeliczenia
- [ ] **PricingExport** - eksport do PDF

#### **Sprint 15-16: Modu≈Ç "Logistyka"**

- [ ] **LogisticsDashboard** - panel logistyczny
- [ ] **RouteOptimizer** - optymalizacja tras
- [ ] **DeliveryTracking** - ≈õledzenie dostaw
- [ ] **CostCalculator** - kalkulator koszt√≥w
- [ ] **Integration z WycenƒÖ** - live updates

#### **Sprint 17-18: Modu≈Ç "Zakwaterowanie"**

- [ ] **AccommodationCalendar** - kalendarz rezerwacji
- [ ] **PartnerCatalog** - katalog partner√≥w
- [ ] **BookingManager** - zarzƒÖdzanie rezerwacjami
- [ ] **Booking API Integration** - integracja z zewnƒôtrznymi API
- [ ] **Cost Management** - zarzƒÖdzanie kosztami

### **5.4 Faza 4: Additional Modules (MiesiƒÖce 10-12)**

#### **Sprint 19-20: Modu≈Ç "Pliki"**

- [ ] **FileExplorer** - drzewo katalog√≥w
- [ ] **FileUploader** - drag&drop upload
- [ ] **FilePreview** - podglƒÖd plik√≥w
- [ ] **FileVersioning** - historia wersji
- [ ] **FileSharing** - wsp√≥≈Çdzielenie plik√≥w

#### **Sprint 21-22: Modu≈Ç "Koncepcja"**

- [ ] **ConceptEditor** - edycja koncepcji
- [ ] **AssetGallery** - galeria mockup√≥w
- [ ] **ApprovalWorkflow** - proces zatwierdzania
- [ ] **VersionControl** - kontrola wersji koncepcji
- [ ] **ClientApproval** - zatwierdzanie przez klienta

#### **Sprint 23-24: Modu≈Ç "Dokumenty"**

- [ ] **DocumentLibrary** - biblioteka dokument√≥w
- [ ] **DocumentUploader** - upload dokument√≥w
- [ ] **DocumentViewer** - podglƒÖd dokument√≥w
- [ ] **DocumentExport** - eksport dokument√≥w
- [ ] **DocumentArchiving** - archiwizacja

### **5.5 Faza 5: Integration & Polish (MiesiƒÖce 13-15)**

#### **Sprint 25-26: Real-time Integration**

- [ ] **Real-time Messaging** - live chat w projekcie
- [ ] **Live Updates** - real-time updates wszystkich modu≈Ç√≥w
- [ ] **Collaboration Features** - wsp√≥≈Çpraca w czasie rzeczywistym
- [ ] **Notification System** - system powiadomie≈Ñ
- [ ] **Presence Indicators** - wska≈∫niki obecno≈õci

#### **Sprint 27-28: Performance & Optimization**

- [ ] **Performance Optimization** - optymalizacja wydajno≈õci
- [ ] **Caching Strategy** - zaawansowane cache'owanie
- [ ] **Bundle Optimization** - optymalizacja bundle'√≥w
- [ ] **Database Optimization** - optymalizacja zapyta≈Ñ
- [ ] **Memory Management** - zarzƒÖdzanie pamiƒôciƒÖ

#### **Sprint 29-30: Testing & Quality Assurance**

- [ ] **E2E Testing** - kompletne testy end-to-end
- [ ] **Performance Testing** - testy wydajno≈õci
- [ ] **Security Testing** - testy bezpiecze≈Ñstwa
- [ ] **Accessibility Testing** - testy dostƒôpno≈õci
- [ ] **User Acceptance Testing** - testy akceptacyjne

---

## üß™ **6. STRATEGIA TESTOWANIA**

### **6.1 Test Pyramid**

```typescript
// Unit Tests (70%)
describe("MaterialStore", () => {
  test("should add material to BOM", () => {
    const store = createMaterialStore();
    store.addBOMItem({ materialId: "1", quantity: 5 });
    expect(store.bomItems).toHaveLength(1);
  });
});

// Integration Tests (20%)
describe("BOM Integration", () => {
  test("should sync BOM with pricing", async () => {
    const material = await createMaterial();
    const bomItem = await addBOMItem(material.id);
    const pricing = await calculatePricing();
    expect(pricing.materialCost).toBeGreaterThan(0);
  });
});

// E2E Tests (10%)
test("complete project workflow", async ({ page }) => {
  await page.goto("/projects/new");
  await page.fill('[name="name"]', "Test Project");
  await page.click('button:has-text("Create")');

  // Test module activation
  await page.click('[data-module="materials"]');
  await page.click('button:has-text("Add Material")');

  // Test pricing calculation
  await page.click('[data-module="pricing"]');
  await expect(page.locator(".total-cost")).toBeVisible();
});
```

### **6.2 Testing Strategy per Module**

#### **Core Modules Testing**

- **Unit Tests**: Store logic, utility functions, validation schemas
- **Integration Tests**: API integration, real-time subscriptions
- **E2E Tests**: Complete user workflows, cross-module interactions

#### **UI Components Testing**

- **Visual Regression**: Screenshot comparison dla components
- **Accessibility**: WCAG AA compliance testing
- **Responsive**: Multi-device testing
- **Performance**: Component rendering performance

#### **Database Testing**

- **Schema Validation**: Database schema integrity
- **RLS Testing**: Row Level Security policies
- **Performance**: Query performance testing
- **Backup/Recovery**: Disaster recovery testing

---

## üîí **7. BEZPIECZE≈ÉSTWO I COMPLIANCE**

### **7.1 Security Measures**

```typescript
// Authentication & Authorization
interface SecurityConfig {
  authentication: {
    provider: "Supabase Auth";
    mfa: boolean;
    sessionTimeout: number;
  };
  authorization: {
    rls: boolean; // Row Level Security
    permissions: PermissionMatrix;
    auditLog: boolean;
  };
  dataProtection: {
    encryption: "AES-256";
    backup: "Encrypted";
    retention: "7 years";
  };
}
```

### **7.2 Compliance Requirements**

- **GDPR**: Data protection i privacy compliance
- **ISO 27001**: Information security management
- **SOC 2**: Security, availability, processing integrity
- **Industry Standards**: Manufacturing industry compliance

---

## üìà **8. METRYKI SUKCESU I MONITORING**

### **8.1 Business Metrics**

```typescript
interface BusinessMetrics {
  efficiency: {
    projectCompletionTime: "20% reduction";
    costAccuracy: "95% accuracy";
    resourceUtilization: "15% improvement";
  };
  quality: {
    errorRate: "< 0.1%";
    clientSatisfaction: "> 4.5/5";
    reworkRate: "< 5%";
  };
  adoption: {
    userAdoption: "90% within 6 months";
    featureUsage: "80% of modules used";
    trainingTime: "< 2 hours per user";
  };
}
```

### **8.2 Technical Metrics**

```typescript
interface TechnicalMetrics {
  performance: {
    pageLoadTime: "< 2 seconds";
    apiResponseTime: "< 100ms";
    uptime: "99.9%";
  };
  scalability: {
    concurrentUsers: "1000+";
    dataVolume: "10TB+";
    responseTime: "Consistent under load";
  };
  quality: {
    testCoverage: "> 80%";
    bugRate: "< 0.1%";
    securityVulnerabilities: "Zero critical";
  };
}
```

---

## üéØ **9. DEFINICJA UKO≈ÉCZENIA (DONE)**

### **9.1 Functional Requirements**

- [ ] **Wszystkie modu≈Çy** dzia≈ÇajƒÖ zgodnie z specyfikacjƒÖ
- [ ] **Real-time updates** dzia≈ÇajƒÖ we wszystkich modu≈Çach
- [ ] **Live calculations** wycen dzia≈ÇajƒÖ poprawnie
- [ ] **Cross-module integration** jest w pe≈Çni funkcjonalna
- [ ] **Mobile responsiveness** na wszystkich urzƒÖdzeniach

### **9.2 Technical Requirements**

- [ ] **Performance** - wszystkie metryki wydajno≈õci spe≈Çnione
- [ ] **Security** - wszystkie testy bezpiecze≈Ñstwa przechodzƒÖ
- [ ] **Testing** - 80%+ code coverage, wszystkie E2E testy przechodzƒÖ
- [ ] **Accessibility** - WCAG AA compliance
- [ ] **Browser Support** - Chrome, Firefox, Safari, Edge

### **9.3 Business Requirements**

- [ ] **User Acceptance** - wszystkie testy UAT przechodzƒÖ
- [ ] **Training Materials** - dokumentacja i materia≈Çy szkoleniowe
- [ ] **Support Process** - proces wsparcia technicznego
- [ ] **Deployment** - production deployment successful
- [ ] **Monitoring** - system monitoringu dzia≈Ça poprawnie

---

## üìö **10. DOKUMENTACJA I ZASOBY**

### **10.1 Technical Documentation**

- **API Documentation** - Swagger/OpenAPI specs
- **Database Schema** - ERD i dokumentacja tabel
- **Component Library** - Storybook documentation
- **Deployment Guide** - Docker i Kubernetes setup
- **Development Guide** - Setup i development workflow

### **10.2 User Documentation**

- **User Manual** - kompletny przewodnik u≈ºytkownika
- **Video Tutorials** - nagrania szkoleniowe
- **FAQ** - najczƒô≈õciej zadawane pytania
- **Support Portal** - portal wsparcia technicznego
- **Release Notes** - notatki o wydaniach

### **10.3 Business Documentation**

- **Business Requirements** - wymagania biznesowe
- **Process Documentation** - dokumentacja proces√≥w
- **Compliance Documentation** - dokumentacja zgodno≈õci
- **Training Materials** - materia≈Çy szkoleniowe
- **Change Management** - zarzƒÖdzanie zmianami

---

## üöÄ **11. NEXT STEPS - IMMEDIATE ACTIONS**

### **Priority 1 (This Week)**

1. [ ] **Finalize Database Schema** - review i approval schematu bazy
2. [ ] **Setup Supabase Project** - konfiguracja ≈õrodowiska
3. [ ] **Create Project Repository** - setup repo z CI/CD
4. [ ] **Design System Review** - finalizacja design tokens

### **Priority 2 (Next 2 Weeks)**

1. [ ] **Implement Core Tables** - stworzenie podstawowych tabel
2. [ ] **Setup Authentication** - konfiguracja Supabase Auth
3. [ ] **Create Base Components** - implementacja komponent√≥w bazowych
4. [ ] **Setup Testing Framework** - konfiguracja test√≥w

### **Priority 3 (Next Month)**

1. [ ] **Implement Project Module** - pierwszy modu≈Ç funkcjonalny
2. [ ] **Setup Real-time** - konfiguracja real-time updates
3. [ ] **Create API Services** - implementacja serwis√≥w API
4. [ ] **Setup CI/CD Pipeline** - automatyzacja deployment

---

**Ten dokument stanowi kompleksowy plan implementacji systemu FabManage-Clean, zapewniajƒÖcy jasne wytyczne dla ca≈Çego zespo≈Çu deweloperskiego oraz stakeholders. Regularne aktualizacje dokumentu bƒôdƒÖ odzwierciedlaƒá postƒôp implementacji oraz ewolucjƒô wymaga≈Ñ projektu.**
